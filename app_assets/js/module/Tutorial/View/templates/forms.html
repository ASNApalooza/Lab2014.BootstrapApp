<div class="page-header">
    <h2>Part 6: Forms</h2>
</div>
<p>
    We will now create a form to create a new contact and edit a contact. The markup
    for both pages will be nearly identical. In a real application, we might suggest
    creating a <a href="http://msdn.microsoft.com/en-us/library/system.web.ui.usercontrol%28v=vs.110%29.aspx">UserControl</a>
    to make the form reusable. In our case, we&rsquo;ll break some rules to cut-and-paste.
</p>
<p>
    Create an ASPX page in the <code>Contacts</code> folder called <code>New.aspx</code>.
    Set the Title attribute to <code>New Contact</code> and change the <code>Content</code>
    control ID to <code>contentMain</code>. After creating the same <code>pnlMainContent</code>
    as previous pages, the page should look like this:
</p>
<div class="panel-group" id="new1-source">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#new1-source" href="#new1-source-body">
                    <code>Contacts\New.aspx</code>
                </a>
            </h4>
        </div>
        <div id="new1-source-body" class="panel-collapse collapse">
            <div class="panel-body">
<pre class="prettyprint linenums">
&lt;%@ Page Language="AVR" MasterPageFile="~/MasterPages/MasterPage.master" AutoEventWireup="false"
    CodeFile="New.aspx.vr" Inherits="Contacts_New" Title="New Contact" %&gt;

&lt;asp:Content ID="contentMain" ContentPlaceHolderID="cphMain" Runat="Server"&gt;
    &lt;asp:Panel ID="pnlMainContent" runat="server" ClientIDMode="Static"&gt;
    &lt;/asp:Panel&gt;&lt;!-- #pnlMainContent --&gt;
&lt;/asp:Content&gt;
</pre>
            </div>
        </div>
    </div>
</div>
<p>
    This page doesn&rsquo;t require any controls other than what is in the form,
    so we will start with the page header. Drag a <code>Panel</code> control inside
    <code>pnlMainContent</code> and set the ID to <code>pnlPageHeader</code>. Set
    the <code>CssClass</code> to <code>page-header</code> and make the ID static.
    Add an <code>&lt;h2&gt;</code> element with the text <code>Contact Form</code>.
    The page should look like this:
</p>
<div class="panel-group" id="new2-source">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#new2-source" href="#new2-source-body">
                    <code>Contacts\New.aspx</code>
                </a>
            </h4>
        </div>
        <div id="new2-source-body" class="panel-collapse collapse">
            <div class="panel-body">
<pre class="prettyprint linenums">
&lt;%@ Page Language="AVR" MasterPageFile="~/MasterPages/MasterPage.master" AutoEventWireup="false"
    CodeFile="New.aspx.vr" Inherits="Contacts_New" Title="New Contact" %&gt;

&lt;asp:Content ID="contentMain" ContentPlaceHolderID="cphMain" Runat="Server"&gt;
    &lt;asp:Panel ID="pnlMainContent" runat="server" ClientIDMode="Static"&gt;
        &lt;asp:Panel ID="pnlPageHeader" CssClass="page-header" runat="server" ClientIDMode="Static"&gt;
            &lt;h2&gt;Contact Form&lt;/h2&gt;
        &lt;/asp:Panel&gt;&lt;!-- #pnlPageHeader --&gt;
    &lt;/asp:Panel&gt;&lt;!-- #pnlMainContent --&gt;
&lt;/asp:Content&gt;
</pre>
            </div>
        </div>
    </div>
</div>
<p>
    We will use the grid system to center and constrain the size of our form.
    Instead of taking 2/3 of the screen, we will use 1/2. Adding the grid markup
    will result in this page:
</p>
<div class="panel-group" id="new3-source">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#new3-source" href="#new3-source-body">
                    <code>Contacts\New.aspx</code>
                </a>
            </h4>
        </div>
        <div id="new3-source-body" class="panel-collapse collapse">
            <div class="panel-body">
<pre class="prettyprint linenums">
&lt;%@ Page Language="AVR" MasterPageFile="~/MasterPages/MasterPage.master" AutoEventWireup="false"
    CodeFile="New.aspx.vr" Inherits="Contacts_New" Title="New Contact" %&gt;

&lt;asp:Content ID="contentMain" ContentPlaceHolderID="cphMain" Runat="Server"&gt;
    &lt;asp:Panel ID="pnlMainContent" runat="server" ClientIDMode="Static"&gt;
        &lt;asp:Panel ID="pnlPageHeader" CssClass="page-header" runat="server" ClientIDMode="Static"&gt;
            &lt;h2&gt;Contact Form&lt;/h2&gt;
        &lt;/asp:Panel&gt;&lt;!-- #pnlPageHeader --&gt;
        &lt;asp:Panel ID="pnlContactFormRow" CssClass="row" runat="server" ClientIDMode="Static"&gt;
            &lt;asp:Panel ID="pnlContactFormCol" CssClass="col-sm-6 col-sm-offset-3" runat="server" ClientIDMode="Static"&gt;
            &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormCol --&gt;
        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormRow --&gt;
    &lt;/asp:Panel&gt;&lt;!-- #pnlMainContent --&gt;
&lt;/asp:Content&gt;
</pre>
            </div>
        </div>
    </div>
</div>
<p>
    We are going to use a Bootstrap form style called a
    <a href="http://getbootstrap.com/css/#forms-horizontal">horizontal form</a>.
    In addition, we will place the form inside a Bootstrap
    <a href="http://getbootstrap.com/components/#panels">panel</a> control (not
    to be confused with the ASP.NET Panel control).
</p>
<p>
    The Bootstrap form documentation tells us to add a CSS class
    <code>form-horizontal</code> to our <code>&lt;form&gt;</code> element. In
    ASP.NET WebForms applications, the page has one form. That form lives in our
    Master Page, and adding a CSS class to that tag could be a bad idea. I&rsquo;ve
    found that adding the <code>form-horizontal</code> class to a basic
    <code>&lt;div&gt;</code> element works fine.
</p>
<p>
    Drag a <code>Panel</code> control inside <code>pnlContactFormCol</code> and
    change the ID to <code>pnlContactForm</code>. Set the <code>CssClass</code>
    to <code>form-horizontal</code> and make the ID static. To create the Bootstrap
    panel, drag a <code>Panel</code> control inside <code>pnlContactForm</code>
    and change the ID to <code>pnlContactFormPanel</code>. Set the <code>CssClass</code>
    to <code>panel panel-default</code> and make the ID static.
</p>
<p>
    A Bootstrap panel can have a heading, a body, and a footer. We will use all
    three. Drag a <code>Panel</code> control inside <code>pnlContactFormPanel</code>
    and change the ID to <code>pnlContactFormPanelHeading</code>. Set the
    <code>CssClass</code> to <code>panel-heading</code> and make the ID static.
    Add an <code>&lt;h3&gt;</code> element inside the new panel with
    <code class="prettyprint">class="panel-title"</code> and the text
    <code>New Contact</code>.
</p>
<p>
    Drag a <code>Panel</code> control after <code>pnlContactFormPanelHeading</code>
    and change the ID to <code>pnlContactFormPanelBody</code>. Set the <code>CssClass</code>
    to <code>panel-body</code> and make the ID static. Drag another <code>Panel</code>
    control after <code>pnlContactFormPanelBody</code> and change the ID to
    <code>pnlContactFormPanelFooter</code>. Set the <code>CssClass</code> to
    <code>panel-footer</code> and make the ID static. We should have something that
    looks like this:
</p>
<div class="panel-group" id="new4-source">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#new4-source" href="#new4-source-body">
                    <code>Contacts\New.aspx</code>
                </a>
            </h4>
        </div>
        <div id="new4-source-body" class="panel-collapse collapse">
            <div class="panel-body">
<pre class="prettyprint linenums">
&lt;%@ Page Language="AVR" MasterPageFile="~/MasterPages/MasterPage.master" AutoEventWireup="false"
    CodeFile="New.aspx.vr" Inherits="Contacts_New" Title="New Contact" %&gt;

&lt;asp:Content ID="contentMain" ContentPlaceHolderID="cphMain" Runat="Server"&gt;
    &lt;asp:Panel ID="pnlMainContent" runat="server" ClientIDMode="Static"&gt;
        &lt;asp:Panel ID="pnlPageHeader" CssClass="page-header" runat="server" ClientIDMode="Static"&gt;
            &lt;h2&gt;Contact Form&lt;/h2&gt;
        &lt;/asp:Panel&gt;&lt;!-- #pnlPageHeader --&gt;
        &lt;asp:Panel ID="pnlContactFormRow" CssClass="row" runat="server" ClientIDMode="Static"&gt;
            &lt;asp:Panel ID="pnlContactFormCol" CssClass="col-sm-6 col-sm-offset-3" runat="server" ClientIDMode="Static"&gt;
                &lt;asp:Panel ID="pnlContactForm" CssClass="form-horizontal" runat="server" ClientIDMode="Static"&gt;
                    &lt;asp:Panel ID="pnlContactFormPanel" CssClass="panel panel-default" runat="server" ClientIDMode="Static"&gt;
                        &lt;asp:Panel ID="pnlContactFormPanelHeading" CssClass="panel-heading" runat="server" ClientIDMode="Static"&gt;
                            &lt;h3 class="panel-title"&gt;New Contact&lt;/h3&gt;
                        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanelHeading --&gt;
                        &lt;asp:Panel ID="pnlContactFormPanelBody" CssClass="panel-body" runat="server" ClientIDMode="Static"&gt;
                        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanelBody --&gt;
                        &lt;asp:Panel ID="pnlContactFormPanelFooter" CssClass="panel-footer" runat="server" ClientIDMode="Static"&gt;
                        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanelFooter --&gt;
                    &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanel --&gt;
                &lt;/asp:Panel&gt;&lt;!-- #pnlContactForm --&gt;
            &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormCol --&gt;
        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormRow --&gt;
    &lt;/asp:Panel&gt;&lt;!-- #pnlMainContent --&gt;
&lt;/asp:Content&gt;
</pre>
            </div>
        </div>
    </div>
</div>
<p>
    The controls used for each form field will follow a pattern. First create a
    <code>Panel</code> control with a <code>CssClass</code> of <code>form-group</code>.
    That <code>Panel</code> will contain a <code>Label</code> control, followed by
    another <code>Panel</code> control. The <code>Label</code> control will have
    a CSS class to set a column width, and the <code>control-label</code> class.
    The <code>Label</code> will also have a <code>Text</code> property and an
    <code>AssociatedControlID</code> property to set. The <code>Panel</code> will
    have a CSS class for column width as well. Within the <code>Panel</code> will
    be the form control and any validation controls. The pattern is easier to see
    with a few examples.
</p>
<p>
    Drag a <code>Panel</code> control inside <code>pnlContactFormPanelBody</code>
    and change the ID to <code>pnlCompany</code>. Set the <code>CssClass</code>
    to <code>form-group</code> and make the ID static. Drag a <code>Label</code>
    control inside the new panel and change the ID to <code>lblCompany</code>. Set
    the <code>CssClass</code> to <code>col-sm-3 control-label</code> and make the
    ID static. Set the <code>AssociatedControlID</code> to <code>txtCompany</code>,
    which we do not have yet. Set the <code>Text</code> to <code>Company</code>.
</p>
<p>
    Drag a <code>Panel</code> control after <code>lblCompany</code> and change the
    ID to <code>pnlTxtCompany</code>. Set the <code>CssClass</code> to
    <code>col-sm-9</code> and make the ID static. Drag a <code>TextBox</code> control
    inside of the new panel and change the ID to <code>txtCompany</code>. Set the
    <code>CssClass</code> to <code>form-control</code> and make the ID static.
</p>
<p>
    Drag a <code>RequiredFieldValidator</code> control from the Validation section
    of the Toolbox after <code>txtCompany</code> and change the ID to
    <code>requiredCompany</code>. Set the <code>Display</code> to <code>Dynamic</code>.
    Set the <code>ControlToValidate</code> to <code>txtCompany</code>. Set the
    <code>ErrorMessage</code> to <code>Please enter the company name</code>.
</p>
<p>
    Drag a <code>RegularExpressionValidator</code> control from the Validation
    section of the Toolbox after the other validator and change the ID to
    <code>lengthCompany</code>. Set the <code>Display</code> to <code>Dynamic</code>.
    Set the <code>ControlToValidate</code> to <code>txtCompany</code>. Set the
    <code>ErrorMessage</code> to <code>Company cannot be longer than 40 characters</code>.
    Finally, set the <code>ValidationExpression</code> to <code>^.{0,40}$</code>.
    That regular expression will ensure the company name is not longer than 40
    characters.
</p>
<p>
    With the first form group complete, the page should look like this:
</p>
<div class="panel-group" id="new5-source">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#new5-source" href="#new5-source-body">
                    <code>Contacts\New.aspx</code>
                </a>
            </h4>
        </div>
        <div id="new5-source-body" class="panel-collapse collapse">
            <div class="panel-body">
<pre class="prettyprint linenums">
&lt;%@ Page Language="AVR" MasterPageFile="~/MasterPages/MasterPage.master" AutoEventWireup="false"
    CodeFile="New.aspx.vr" Inherits="Contacts_New" Title="New Contact" %&gt;

&lt;asp:Content ID="contentMain" ContentPlaceHolderID="cphMain" Runat="Server"&gt;
    &lt;asp:Panel ID="pnlMainContent" runat="server" ClientIDMode="Static"&gt;
        &lt;asp:Panel ID="pnlPageHeader" CssClass="page-header" runat="server" ClientIDMode="Static"&gt;
            &lt;h2&gt;Contact Form&lt;/h2&gt;
        &lt;/asp:Panel&gt;&lt;!-- #pnlPageHeader --&gt;
        &lt;asp:Panel ID="pnlContactFormRow" CssClass="row" runat="server" ClientIDMode="Static"&gt;
            &lt;asp:Panel ID="pnlContactFormCol" CssClass="col-sm-6 col-sm-offset-3" runat="server" ClientIDMode="Static"&gt;
                &lt;asp:Panel ID="pnlContactForm" CssClass="form-horizontal" runat="server" ClientIDMode="Static"&gt;
                    &lt;asp:Panel ID="pnlContactFormPanel" CssClass="panel panel-default" runat="server" ClientIDMode="Static"&gt;
                        &lt;asp:Panel ID="pnlContactFormPanelHeading" CssClass="panel-heading" runat="server" ClientIDMode="Static"&gt;
                            &lt;h3 class="panel-title"&gt;New Contact&lt;/h3&gt;
                        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanelHeading --&gt;
                        &lt;asp:Panel ID="pnlContactFormPanelBody" CssClass="panel-body" runat="server" ClientIDMode="Static"&gt;
                            &lt;asp:Panel ID="pnlCompany" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblCompany" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtCompany"
                                    Text="Company"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtCompany" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtCompany" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredCompany" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtCompany"
                                        ErrorMessage="Please enter the company name"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthCompany" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtCompany"
                                        ErrorMessage="Company cannot be longer than 40 characters"
                                        ValidationExpression="^.{0,40}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanelBody --&gt;
                        &lt;asp:Panel ID="pnlContactFormPanelFooter" CssClass="panel-footer" runat="server" ClientIDMode="Static"&gt;
                        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanelFooter --&gt;
                    &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanel --&gt;
                &lt;/asp:Panel&gt;&lt;!-- #pnlContactForm --&gt;
            &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormCol --&gt;
        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormRow --&gt;
    &lt;/asp:Panel&gt;&lt;!-- #pnlMainContent --&gt;
&lt;/asp:Content&gt;
</pre>
            </div>
        </div>
    </div>
</div>
<p>
    Following the same pattern for the other fields will result in the complete
    form. Each field may need different validations, and the state field uses a
    <code>DropDownList</code> control, but the approach is the same for each field.
</p>
<p>
    In the footer, we need to add a &ldquo;Cancel&rdquo; button and a
    &ldquo;Save Contact&rdquo; button. Drag a <code>Panel</code> control inside
    <code>pnlContactFormPanelFooter</code> and change the ID to
    <code>pnlContactFormActions</code>. Set the <code>CssClass</code> to
    <code>clearfix</code> and make the ID static. The <code>clearfix</code> class
    fixes display issues resulting from floating one button to the left and
    another button to the right. The cancel button can be a link back to the
    index page. The submit button can be a <code>Button</code> control, and we
    will handle the form submission when it is clicked. The complete page should
    look like this:
</p>
<div class="panel-group" id="new6-source">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#new6-source" href="#new6-source-body">
                    <code>Contacts\New.aspx</code>
                </a>
            </h4>
        </div>
        <div id="new6-source-body" class="panel-collapse collapse">
            <div class="panel-body">
<pre class="prettyprint linenums">
&lt;%@ Page Language="AVR" MasterPageFile="~/MasterPages/MasterPage.master" AutoEventWireup="false"
    CodeFile="New.aspx.vr" Inherits="Contacts_New" Title="New Contact" %&gt;

&lt;asp:Content ID="contentMain" ContentPlaceHolderID="cphMain" Runat="Server"&gt;
    &lt;asp:Panel ID="pnlMainContent" runat="server" ClientIDMode="Static"&gt;
        &lt;asp:Panel ID="pnlPageHeader" CssClass="page-header" runat="server" ClientIDMode="Static"&gt;
            &lt;h2&gt;Contact Form&lt;/h2&gt;
        &lt;/asp:Panel&gt;&lt;!-- #pnlPageHeader --&gt;
        &lt;asp:Panel ID="pnlContactFormRow" CssClass="row" runat="server" ClientIDMode="Static"&gt;
            &lt;asp:Panel ID="pnlContactFormCol" CssClass="col-sm-6 col-sm-offset-3" runat="server" ClientIDMode="Static"&gt;
                &lt;asp:Panel ID="pnlContactForm" CssClass="form-horizontal" runat="server" ClientIDMode="Static"&gt;
                    &lt;asp:Panel ID="pnlContactFormPanel" CssClass="panel panel-default" runat="server" ClientIDMode="Static"&gt;
                        &lt;asp:Panel ID="pnlContactFormPanelHeading" CssClass="panel-heading" runat="server" ClientIDMode="Static"&gt;
                            &lt;h3 class="panel-title"&gt;New Contact&lt;/h3&gt;
                        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanelHeading --&gt;
                        &lt;asp:Panel ID="pnlContactFormPanelBody" CssClass="panel-body" runat="server" ClientIDMode="Static"&gt;
                            &lt;asp:Panel ID="pnlCompany" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblCompany" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtCompany"
                                    Text="Company"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtCompany" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtCompany" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredCompany" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtCompany"
                                        ErrorMessage="Please enter the company name"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthCompany" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtCompany"
                                        ErrorMessage="Company cannot be longer than 40 characters"
                                        ValidationExpression="^.{0,40}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlFirstName" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblFirstName" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtFirstName"
                                    Text="First Name"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtFirstName" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtFirstName" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredFirstName" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtFirstName"
                                        ErrorMessage="Please enter the first name"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthFirstName" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtFirstName"
                                        ErrorMessage="First name cannot be longer than 40 characters"
                                        ValidationExpression="^.{0,40}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlLastName" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblLastName" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtLastName"
                                    Text="Last Name"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtLastName" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtLastName" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredLastName" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtLastName"
                                        ErrorMessage="Please enter the last name"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthLastName" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtLastName"
                                        ErrorMessage="Last name cannot be longer than 40 characters"
                                        ValidationExpression="^.{0,40}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlEmail" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblEmail" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtEmail"
                                    Text="Email"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtEmail" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtEmail" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredEmail" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtEmail"
                                        ErrorMessage="Please enter the email address"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthEmail" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtEmail"
                                        ErrorMessage="Email cannot be longer than 40 characters"
                                        ValidationExpression="^.{0,40}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="validEmail" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtEmail"
                                        ErrorMessage="Email is not valid"
                                        ValidationExpression="^([a-zA-Z0-9][-.\w]*@([a-zA-Z0-9][-\w]*[a-zA-Z0-9]\.)+[a-zA-Z]{2,9})$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlPhone" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblPhone" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtPhone"
                                    Text="Phone"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtPhone" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtPhone" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredPhone" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtPhone"
                                        ErrorMessage="Please enter the phone"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthPhone" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtPhone"
                                        ErrorMessage="Phone cannot be longer than 12 characters"
                                        ValidationExpression="^.{0,12}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="numericPhone" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtPhone"
                                        ErrorMessage="Phone must be numeric only"
                                        ValidationExpression="\d+"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlAddress1" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblAddress1" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtAddress1"
                                    Text="Address Line 1"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtAddress1" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtAddress1" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredAddress1" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtAddress1"
                                        ErrorMessage="Please enter the address line 1"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthAddress1" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtAddress1"
                                        ErrorMessage="Address line 1 cannot be longer than 35 characters"
                                        ValidationExpression="^.{0,35}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlAddress2" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblAddress2" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtAddress2"
                                    Text="Address Line 2"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtAddress2" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtAddress2" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthAddress2" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtAddress2"
                                        ErrorMessage="Address line 2 cannot be longer than 35 characters"
                                        ValidationExpression="^.{0,35}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlCity" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblCity" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtCity"
                                    Text="City"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtCity" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtCity" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredCity" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtCity"
                                        ErrorMessage="Please enter the city"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthCity" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtCity"
                                        ErrorMessage="City cannot be longer than 30 characters"
                                        ValidationExpression="^.{0,30}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlState" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblState" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="ddlState"
                                    Text="State"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlDdlState" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:DropDownList ID="ddlState" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:DropDownList&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredState" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="ddlState"
                                        ErrorMessage="Please select the state"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlPostalCode" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblPostalCode" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtPostalCode"
                                    Text="Postal Code"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtPostalCode" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtPostalCode" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredPostalCode" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtPostalCode"
                                        ErrorMessage="Please enter the postal code"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthPostalCode" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtPostalCode"
                                        ErrorMessage="Postal code cannot be longer than 10 characters"
                                        ValidationExpression="^.{0,10}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanelBody --&gt;
                        &lt;asp:Panel ID="pnlContactFormPanelFooter" CssClass="panel-footer" runat="server" ClientIDMode="Static"&gt;
                            &lt;asp:Panel ID="pnlContactFormPanelActions" CssClass="clearfix" runat="server" ClientIDMode="Static"&gt;
                                &lt;a href="&lt;%= Page.ResolveUrl("~") %&gt;Contacts/Index.aspx" class="btn btn-sm btn-default"&gt;
                                    &lt;span class="glyphicon glyphicon-ban-circle"&gt;&lt;/span&gt; Cancel
                                &lt;/a&gt;
                                &lt;asp:Button ID="btnSubmit" CssClass="btn btn-sm btn-primary pull-right" runat="server" Text="Save Contact" /&gt;
                            &lt;/asp:Panel&gt;
                        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanelFooter --&gt;
                    &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanel --&gt;
                &lt;/asp:Panel&gt;&lt;!-- #pnlContactForm --&gt;
            &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormCol --&gt;
        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormRow --&gt;
    &lt;/asp:Panel&gt;&lt;!-- #pnlMainContent --&gt;
&lt;/asp:Content&gt;
</pre>
            </div>
        </div>
    </div>
</div>
<p>
    For the form to work, we need to write the code-behind. Open
    <code>Contacts\New.aspx.vr</code> and make sure it extends the
    <code>BasePage</code>. Add a Using statement for
    <code>System.Collections.Generic</code> and delete the <code>Page_Unload</code>
    method. First, we need to populate the states <code>DropDownList</code>
    control on the initial page load. The code is simple using the StateData
    helper class. We also add an empty option that says &ldquo;Please select a
    state&rdquo;. The class should look like this:
</p>
<div class="panel-group" id="new-vr1-source">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#new-vr1-source" href="#new-vr1-source-body">
                    <code>Contacts\New.aspx.vr</code>
                </a>
            </h4>
        </div>
        <div id="new-vr1-source-body" class="panel-collapse collapse">
            <div class="panel-body">
<pre class="prettyprint linenums">
Using System
Using System.Data
Using System.Configuration
Using System.Collections
Using System.Collections.Generic
Using System.Web
Using System.Web.Security
Using System.Web.UI
Using System.Web.UI.WebControls
Using System.Web.UI.WebControls.WebParts
Using System.Web.UI.HtmlControls

BegClass Contacts_New Partial(*Yes) Access(*Public) Extends(BasePage)

    BegSr Page_Load Access(*Private) Event(*This.Load)
        DclSrParm sender Type(*Object)
        DclSrParm e Type(System.EventArgs)

        If (NOT Page.IsPostBack)
            LoadStatesDropDown()
        EndIf
    EndSr

    BegSr LoadStatesDropDown Access(*Private)

        DclFld states Type(List(*Of ListItem))

        ddlState.Items.Add(*New ListItem("Please select a state", ""))

        states = StateData.GetStates()

        ForEach item Type(ListItem) Collection(states)
            ddlState.Items.Add(item)
        EndFor
    EndSr

EndClass
</pre>
            </div>
        </div>
    </div>
</div>
<p>
    Now we need to add a click event to handle <code>btnSubmit</code>. In
    <code>Contacts\New.aspx</code> design mode, double-click on the Save Contact
    button to create the method. In the method, create a new <code>Contact</code>
    object and set each property from the form controls. Then retrieve the
    contact repository from the <code>Registry</code> and pass the new contact
    object to the <code>addContact</code> method. Finally, redirect the user
    back to the index page. With the new method, the class should look like this:
</p>
<div class="panel-group" id="new-vr2-source">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#new-vr2-source" href="#new-vr2-source-body">
                    <code>Contacts\New.aspx.vr</code>
                </a>
            </h4>
        </div>
        <div id="new-vr2-source-body" class="panel-collapse collapse">
            <div class="panel-body">
<pre class="prettyprint linenums">
Using System
Using System.Data
Using System.Configuration
Using System.Collections
Using System.Collections.Generic
Using System.Web
Using System.Web.Security
Using System.Web.UI
Using System.Web.UI.WebControls
Using System.Web.UI.WebControls.WebParts
Using System.Web.UI.HtmlControls

BegClass Contacts_New Partial(*Yes) Access(*Public) Extends(BasePage)

    BegSr Page_Load Access(*Private) Event(*This.Load)
        DclSrParm sender Type(*Object)
        DclSrParm e Type(System.EventArgs)

        If (NOT Page.IsPostBack)
            LoadStatesDropDown()
        EndIf
    EndSr

    BegSr LoadStatesDropDown Access(*Private)

        DclFld states Type(List(*Of ListItem))

        ddlState.Items.Add(*New ListItem("Please select a state", ""))

        states = StateData.GetStates()

        ForEach item Type(ListItem) Collection(states)
            ddlState.Items.Add(item)
        EndFor
    EndSr

    BegSr btnSubmit_Click Access(*Private) Event(*This.btnSubmit.Click)
        DclSrParm sender Type(*Object)
        DclSrParm e Type(System.EventArgs)

        DclFld contactEntity Type(Contact)
        DclFld contactRepo Type(IContactRepository)

        contactEntity = *New Contact()

        contactEntity.company = txtCompany.Text.Trim()
        contactEntity.firstName = txtFirstName.Text.Trim()
        contactEntity.lastName = txtLastName.Text.Trim()
        contactEntity.email = txtEmail.Text.Trim()
        contactEntity.phone = txtPhone.Text.Trim()
        contactEntity.address1 = txtAddress1.Text.Trim()
        If (Not String.IsNullOrEmpty(txtAddress2.Text.Trim()))
            contactEntity.address2 = txtAddress2.Text.Trim()
        Else
            contactEntity.address2 = *Nothing
        EndIf
        contactEntity.city = txtCity.Text.Trim()
        contactEntity.state = ddlState.SelectedValue.Trim()
        contactEntity.postalCode = txtPostalCode.Text.Trim()

        contactRepo = *Base.serviceRegistry.GetContactRepository()
        contactRepo.AddContact(contactEntity)

        Response.Redirect("Index.aspx")
    EndSr

EndClass
</pre>
            </div>
        </div>
    </div>
</div>
<p>
    If everything is correct, you should be able to run the application and add
    contacts with the new contact form. The edit contact page will be easy now,
    so let&rsquo;s finish that up.
</p>
<p>
    Create a new ASPX page in the <code>Contacts</code> folder called
    <code>Edit.aspx</code>. Set the Title attribute to <code>Edit Contact</code>.
    Now replace everything except the first line with the contents of
    <code>Contacts\New.aspx</code> starting on line 2. We&rsquo;ll make one
    small change. Replace &ldquo;New Contact&rdquo; in the panel title with a
    <code>Literal</code> control from the Toolbox. Change the ID of the control
    to <code>contactName</code>. We will set this value in the code behind. The
    page looks like this:
</p>
<div class="panel-group" id="edit-source">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#edit-source" href="#edit-source-body">
                    <code>Contacts\Edit.aspx</code>
                </a>
            </h4>
        </div>
        <div id="edit-source-body" class="panel-collapse collapse">
            <div class="panel-body">
<pre class="prettyprint linenums">
&lt;%@ Page Language="AVR" MasterPageFile="~/MasterPages/MasterPage.master" AutoEventWireup="false"
    CodeFile="Edit.aspx.vr" Inherits="Contacts_Edit" Title="Edit Contact" %&gt;

&lt;asp:Content ID="contentMain" ContentPlaceHolderID="cphMain" Runat="Server"&gt;
    &lt;asp:Panel ID="pnlMainContent" runat="server" ClientIDMode="Static"&gt;
        &lt;asp:Panel ID="pnlPageHeader" CssClass="page-header" runat="server" ClientIDMode="Static"&gt;
            &lt;h2&gt;Contact Form&lt;/h2&gt;
        &lt;/asp:Panel&gt;&lt;!-- #pnlPageHeader --&gt;
        &lt;asp:Panel ID="pnlContactFormRow" CssClass="row" runat="server" ClientIDMode="Static"&gt;
            &lt;asp:Panel ID="pnlContactFormCol" CssClass="col-sm-6 col-sm-offset-3" runat="server" ClientIDMode="Static"&gt;
                &lt;asp:Panel ID="pnlContactForm" CssClass="form-horizontal" runat="server" ClientIDMode="Static"&gt;
                    &lt;asp:Panel ID="pnlContactFormPanel" CssClass="panel panel-default" runat="server" ClientIDMode="Static"&gt;
                        &lt;asp:Panel ID="pnlContactFormPanelHeading" CssClass="panel-heading" runat="server" ClientIDMode="Static"&gt;
                            &lt;h3 class="panel-title"&gt;&lt;asp:Literal ID="contactName" runat="server"&gt;&lt;/asp:Literal&gt;&lt;/h3&gt;
                        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanelHeading --&gt;
                        &lt;asp:Panel ID="pnlContactFormPanelBody" CssClass="panel-body" runat="server" ClientIDMode="Static"&gt;
                            &lt;asp:Panel ID="pnlCompany" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblCompany" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtCompany"
                                    Text="Company"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtCompany" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtCompany" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredCompany" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtCompany"
                                        ErrorMessage="Please enter the company name"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthCompany" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtCompany"
                                        ErrorMessage="Company cannot be longer than 40 characters"
                                        ValidationExpression="^.{0,40}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlFirstName" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblFirstName" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtFirstName"
                                    Text="First Name"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtFirstName" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtFirstName" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredFirstName" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtFirstName"
                                        ErrorMessage="Please enter the first name"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthFirstName" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtFirstName"
                                        ErrorMessage="First name cannot be longer than 40 characters"
                                        ValidationExpression="^.{0,40}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlLastName" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblLastName" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtLastName"
                                    Text="Last Name"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtLastName" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtLastName" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredLastName" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtLastName"
                                        ErrorMessage="Please enter the last name"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthLastName" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtLastName"
                                        ErrorMessage="Last name cannot be longer than 40 characters"
                                        ValidationExpression="^.{0,40}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlEmail" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblEmail" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtEmail"
                                    Text="Email"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtEmail" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtEmail" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredEmail" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtEmail"
                                        ErrorMessage="Please enter the email address"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthEmail" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtEmail"
                                        ErrorMessage="Email cannot be longer than 40 characters"
                                        ValidationExpression="^.{0,40}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="validEmail" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtEmail"
                                        ErrorMessage="Email is not valid"
                                        ValidationExpression="^([a-zA-Z0-9][-.\w]*@([a-zA-Z0-9][-\w]*[a-zA-Z0-9]\.)+[a-zA-Z]{2,9})$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlPhone" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblPhone" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtPhone"
                                    Text="Phone"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtPhone" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtPhone" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredPhone" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtPhone"
                                        ErrorMessage="Please enter the phone"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthPhone" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtPhone"
                                        ErrorMessage="Phone cannot be longer than 12 characters"
                                        ValidationExpression="^.{0,12}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="numericPhone" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtPhone"
                                        ErrorMessage="Phone must be numeric only"
                                        ValidationExpression="\d+"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlAddress1" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblAddress1" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtAddress1"
                                    Text="Address Line 1"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtAddress1" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtAddress1" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredAddress1" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtAddress1"
                                        ErrorMessage="Please enter the address line 1"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthAddress1" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtAddress1"
                                        ErrorMessage="Address line 1 cannot be longer than 35 characters"
                                        ValidationExpression="^.{0,35}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlAddress2" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblAddress2" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtAddress2"
                                    Text="Address Line 2"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtAddress2" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtAddress2" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthAddress2" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtAddress2"
                                        ErrorMessage="Address line 2 cannot be longer than 35 characters"
                                        ValidationExpression="^.{0,35}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlCity" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblCity" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtCity"
                                    Text="City"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtCity" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtCity" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredCity" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtCity"
                                        ErrorMessage="Please enter the city"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthCity" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtCity"
                                        ErrorMessage="City cannot be longer than 30 characters"
                                        ValidationExpression="^.{0,30}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlState" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblState" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="ddlState"
                                    Text="State"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlDdlState" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:DropDownList ID="ddlState" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:DropDownList&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredState" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="ddlState"
                                        ErrorMessage="Please select the state"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                            &lt;asp:Panel ID="pnlPostalCode" runat="server" CssClass="form-group" ClientIDMode="Static"&gt;
                                &lt;asp:Label ID="lblPostalCode" CssClass="col-sm-3 control-label" runat="server" ClientIDMode="Static"
                                    AssociatedControlID="txtPostalCode"
                                    Text="Postal Code"&gt;&lt;/asp:Label&gt;
                                &lt;asp:Panel ID="pnlTxtPostalCode" CssClass="col-sm-9" runat="server" ClientIDMode="Static"&gt;
                                    &lt;asp:TextBox ID="txtPostalCode" runat="server" CssClass="form-control" ClientIDMode="Static"&gt;&lt;/asp:TextBox&gt;
                                    &lt;asp:RequiredFieldValidator ID="requiredPostalCode" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtPostalCode"
                                        ErrorMessage="Please enter the postal code"&gt;&lt;/asp:RequiredFieldValidator&gt;
                                    &lt;asp:RegularExpressionValidator ID="lengthPostalCode" runat="server"
                                        Display="Dynamic"
                                        ControlToValidate="txtPostalCode"
                                        ErrorMessage="Postal code cannot be longer than 10 characters"
                                        ValidationExpression="^.{0,10}$"&gt;&lt;/asp:RegularExpressionValidator&gt;
                                &lt;/asp:Panel&gt;
                            &lt;/asp:Panel&gt;
                        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanelBody --&gt;
                        &lt;asp:Panel ID="pnlContactFormPanelFooter" CssClass="panel-footer" runat="server" ClientIDMode="Static"&gt;
                            &lt;asp:Panel ID="pnlContactFormPanelActions" CssClass="clearfix" runat="server" ClientIDMode="Static"&gt;
                                &lt;a href="&lt;%= Page.ResolveUrl("~") %&gt;Contacts/Index.aspx" class="btn btn-sm btn-default"&gt;
                                    &lt;span class="glyphicon glyphicon-ban-circle"&gt;&lt;/span&gt; Cancel
                                &lt;/a&gt;
                                &lt;asp:Button ID="btnSubmit" CssClass="btn btn-sm btn-primary pull-right" runat="server" Text="Save Contact" /&gt;
                            &lt;/asp:Panel&gt;
                        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanelFooter --&gt;
                    &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormPanel --&gt;
                &lt;/asp:Panel&gt;&lt;!-- #pnlContactForm --&gt;
            &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormCol --&gt;
        &lt;/asp:Panel&gt;&lt;!-- #pnlContactFormRow --&gt;
    &lt;/asp:Panel&gt;&lt;!-- #pnlMainContent --&gt;
&lt;/asp:Content&gt;
</pre>
            </div>
        </div>
    </div>
</div>
<p>
    The code-behind for the edit page is also similar to the new page. In
    addition to loading the states, we will need to set the initial control
    values on the initial page load. Fetch the contact using the
    <code>*Base.FetchContact()</code> method. Set the <code>Text</code> of the
    <code>contactName</code> control to be the contact first name, a space, then
    the contact last name. Then set the form fields to the values from the fetched
    contact.
</p>
<div class="alert alert-info">
    It is important to set the form fields only on the initial page load. View
    state will keep the values after then, and we do not want to replace user
    input with values from the database during a post-back.
</div>
<p>
    In the <code>btnSubmit_Click</code> method we need to fetch the contact
    instead of creating a new one. That means we also use the <code>UpdateContact</code>
    method instead of <code>AddContact</code>. Finally, we will redirect the
    user to the <code>Show.aspx</code> page instead of the index page, which
    requires we add the contact ID to the query string. The class code should
    look like this:
</p>
<div class="panel-group" id="edit-vr-source">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#edit-vr-source" href="#edit-vr-source-body">
                    <code>Contacts\Edit.aspx.vr</code>
                </a>
            </h4>
        </div>
        <div id="edit-vr-source-body" class="panel-collapse collapse">
            <div class="panel-body">
<pre class="prettyprint linenums">
Using System
Using System.Data
Using System.Configuration
Using System.Collections
Using System.Collections.Generic
Using System.Web
Using System.Web.Security
Using System.Web.UI
Using System.Web.UI.WebControls
Using System.Web.UI.WebControls.WebParts
Using System.Web.UI.HtmlControls

BegClass Contacts_Edit Partial(*Yes) Access(*Public) Extends(BasePage)

    BegSr Page_Load Access(*Private) Event(*This.Load)
        DclSrParm sender Type(*Object)
        DclSrParm e Type(System.EventArgs)

        If (NOT Page.IsPostBack)
            LoadStatesDropDown()
            LoadContactData()
        EndIf
    EndSr

    BegSr LoadStatesDropDown Access(*Private)

        DclFld states Type(List(*Of ListItem))

        ddlState.Items.Add(*New ListItem("Please select a state", ""))

        states = StateData.GetStates()

        ForEach item Type(ListItem) Collection(states)
            ddlState.Items.Add(item)
        EndFor
    EndSr

    BegSr LoadContactData Access(*Private)

        DclFld contactEntity Type(Contact)

        contactEntity = *Base.FetchContact()

        // Contact name for the panel heading
        contactName.Text = contactEntity.firstName.Trim() + " " + contactEntity.lastName.Trim()

        // Form fields
        txtCompany.Text = contactEntity.company.Trim()
        txtFirstName.Text = contactEntity.firstName.Trim()
        txtLastName.Text = contactEntity.lastName.Trim()
        txtEmail.Text = contactEntity.email.Trim()
        txtPhone.Text = contactEntity.phone.Trim()
        txtAddress1.Text = contactEntity.address1.Trim()
        If (contactEntity.address2 <> *Nothing)
            txtAddress2.Text = contactEntity.address2.ToString().Trim()
        Else
            txtAddress2.Text = String.Empty
        EndIf
        txtCity.Text = contactEntity.city.Trim()
        ddlState.SelectedValue = contactEntity.state.Trim()
        txtPostalCode.Text = contactEntity.postalCode.Trim()
    EndSr

    BegSr btnSubmit_Click Access(*Private) Event(*This.btnSubmit.Click)
        DclSrParm sender Type(*Object)
        DclSrParm e Type(System.EventArgs)

        DclFld contactEntity Type(Contact)
        DclFld contactRepo Type(IContactRepository)

        contactEntity = *Base.FetchContact()

        contactEntity.company = txtCompany.Text.Trim()
        contactEntity.firstName = txtFirstName.Text.Trim()
        contactEntity.lastName = txtLastName.Text.Trim()
        contactEntity.email = txtEmail.Text.Trim()
        contactEntity.phone = txtPhone.Text.Trim()
        contactEntity.address1 = txtAddress1.Text.Trim()
        If (Not String.IsNullOrEmpty(txtAddress2.Text.Trim()))
            contactEntity.address2 = txtAddress2.Text.Trim()
        Else
            contactEntity.address2 = *Nothing
        EndIf
        contactEntity.city = txtCity.Text.Trim()
        contactEntity.state = ddlState.SelectedValue.Trim()
        contactEntity.postalCode = txtPostalCode.Text.Trim()

        contactRepo = *Base.serviceRegistry.GetContactRepository()
        contactRepo.UpdateContact(contactEntity)

        Response.Redirect("Show.aspx?id=" + contactEntity.id.ToString())
    EndSr

EndClass
</pre>
            </div>
        </div>
    </div>
</div>
<p>
    Now the application should do everything we need it to, other than deleting
    contacts. We will complete the <code>Contacts\Delete.aspx</code> page and
    the application in the next part.
</p>
<p>
    Click the <strong>Next</strong> button below to continue when you are ready.
</p>
<hr>
<ul class="pager">
    <li class="previous"><a href="/Lab2014.BootstrapApp/#tutorial/part-5-show" data-asna-nav="route:tutorial:show">&larr; Previous</a></li>
    <li class="next"><a href="/Lab2014.BootstrapApp/#tutorial/part-7-delete" data-asna-nav="route:tutorial:delete">Next &rarr;</a></li>
</ul>
<hr>